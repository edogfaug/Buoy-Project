import serial
import time
import re
batterypercentage = 19
# Open a serial connection with the radio module
ser = serial.Serial('COM8', 9600, timeout=1)
ser.close()
while (batterypercentage < 20):
    ser.open()
    ser.write(b'+++')
    time.sleep(3)
    ser.write(b'AT%V\r\n')
    response = ser.read(100)
    response = response.decode()
    for char in '\OKr':
        response = response.replace(char,'')
    decimal_value = int(response, 16)
    result = decimal_value / 1000
    print(result, "Volts")
    ser.close()
